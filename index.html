<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Registro de Usuario</title>
</head>
<body>
    <h2>Formulario de Registro</h2>
    <form id="userForm">
        <label>Nombre:
            <input type="text" name="name" maxlength="64" required>
        </label><br>
        <label>Apellido:
            <input type="text" name="last_name" maxlength="64" required>
        </label><br>
        <label>Email:
            <input type="email" name="email" required>
        </label><br>
        <label>Número de tarjeta:
            <input type="text" name="card_number" minlength="13" maxlength="16" required>
        </label><br>
        <label>Expiración (MM/YY):
            <input type="text" name="card_expiration" pattern="^(0[1-9]|1[0-2])\/\d{2}$" required>
        </label><br>
        <label>CVV:
            <input type="text" name="card_cvv" pattern="^\d{3,4}$" minlength="3" maxlength="4" required>
        </label><br>
        <label>País:
            <input type="text" name="country" maxlength="64" required>
        </label><br>
        <label>Ciudad:
            <input type="text" name="city" maxlength="64" required>
        </label><br>
        <label>Dirección:
            <input type="text" name="address" maxlength="256" required>
        </label><br>
        <label>Código Postal:
            <input type="text" name="postal_code" maxlength="20" required>
        </label><br>
        <label>Teléfono:
            <input type="text" name="phone" maxlength="20" required>
        </label><br>
        <button type="submit">Enviar</button>
    </form>
    <div id="response"></div>
    <script>
        document.getElementById('userForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const form = e.target;
            const data = {};
            for (const el of form.elements) {
                if (el.name) data[el.name] = el.value;
            }
            const response = await fetch('https://microservice2.pythonanywhere.com//check', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            });
            const result = await response.json();
            document.getElementById('response').textContent = result.success ? "Registro exitoso" : "Error: " + result.error;
        });
    </script>
</body>
</html>
